import{S as ce,i as fe,s as ue,k as E,l as P,m as $,h as _,b as X,J as Xe,H as ee,K as Me,L as je,M as Ge,N as Te,O as We,y as R,z as F,A as z,g as G,d as W,B as U,a as x,c as D,q as w,r as A,n as T,P as Ye,G as m,Q as Se,R as qe,T as Re,p as re,u as le,U as Fe,V as ze,W as Ue}from"../chunks/index.be4ace1f.js";import{X as Je,C as Ee,i as Ke,c as ne,a as Qe,b as Oe,D as _e,d as Ce,l as Ze,e as Be,g as Ne,f as xe,h as et,s as tt,j as st,k as De,m as nt,n as it,V as ot,M as ve,o as Ve,t as at,p as lt,q as rt,S as ct}from"../chunks/post.522681b4.js";import{b as we}from"../chunks/paths.beccaf6e.js";class ft extends Je{constructor(){super(...arguments),this.curveType=Ee.MonotoneX,this.lineWidth=2,this.lineDashArray=void 0,this.fallbackValue=void 0,this.highlightOnHover=!1,this.cursor=null}}const ut=Ke`
  :root {
    --vis-line-cursor: default;
    --vis-line-stroke-dasharray: none;
    --vis-line-stroke-dashoffset: 0;
  }
`,ht=ne`
  label: line-component;
`,se=ne`
  label: line;
  transition: opacity 200ms;
  cursor: var(--vis-line-cursor);
`,ye=ne`
  label: linePath;
  fill: none;
  stroke-dasharray: var(--vis-line-stroke-dasharray);
  stroke-dashoffset: var(--vis-line-stroke-dashoffset);
`,be=ne`
  label: lineSelectionHelper;
  fill: none;
  stroke: rgba(0, 0, 0, 0);
  stroke-width: 8px;
`,ke=ne`
  opacity: 0.2;
`,dt=Object.freeze(Object.defineProperty({__proto__:null,dim:ke,globalStyles:ut,line:se,linePath:ye,lineSelectionHelper:be,root:ht},Symbol.toStringTag,{value:"Module"}));class ie extends Qe{constructor(e){super(),this.config=new ft,this.curve=Oe[Ee.MonotoneX],this.events={[ie.selectors.line]:{mouseover:this._highlight.bind(this),mouseleave:this._resetHighlight.bind(this)}},e&&this.config.init(e)}get bleed(){const{config:{lineWidth:e}}=this,t=this.yScale.domain(),l=(this.yScale.range()[0]>this.yScale.range()[1]?_e.North:_e.South)===_e.South,u=e>3,r=e>=10;return{top:!r&&(!l&&t[1]===0||l&&t[0]===0)?0:e/2,bottom:!r&&(!l&&t[0]===0||l&&t[1]===0)?0:e/2,left:u?e/2:0,right:u?e/2:0}}_render(e){super._render(e);const{config:t,datamodel:{data:n}}=this,l=Ce(e)?e:t.duration;this.curve=Oe[t.curveType],this.lineGen=Ze().x(s=>s.x).y(s=>s.y).defined(s=>s.defined).curve(this.curve);const u=Be(t.y)?t.y:[t.y],r=n.map((s,i)=>this.xScale(Ne(s,t.x,i))),h=u.map(s=>{const i=n.map((g,k)=>{const S=Ne(g,s,k),O=(Ce(S)||S===null)&&isFinite(S)?S:t.fallbackValue;return{x:r[k],y:this.yScale(O??0),defined:isFinite(O),value:O}}),f=i.reduce((g,k)=>k.defined||g,!1),p=f&&i.some(g=>g.value!==null);return{values:i,defined:f,visible:p}}),d=this.g.selectAll(`.${se}`).data(h),a=d.enter().append("g").attr("class",se);a.append("path").attr("class",ye).attr("d",this._emptyPath()).attr("stroke",(s,i)=>xe(n,t.color,i)).attr("stroke-opacity",0).attr("stroke-width",t.lineWidth),a.append("path").attr("class",be).attr("d",this._emptyPath());const c=a.merge(d);c.style("cursor",(s,i)=>et(n,t.cursor,i)),c.each((s,i,f)=>{var p;const g=tt(f[i]),k=g.select(`.${ye}`),S=g.select(`.${be}`),O=s.visible,H=st(s,t.lineDashArray,i),j=De(k,l).attr("stroke",xe(n,t.color,i)).attr("stroke-width",t.lineWidth).attr("stroke-opacity",O?1:0).style("stroke-dasharray",(p=H==null?void 0:H.join(" "))!==null&&p!==void 0?p:null),y=s.values.some(M=>!M.defined),v=this.lineGen(s.values);if(l&&!y){const M=k.attr("d")||this._emptyPath(),Y=v||this._emptyPath();j.attrTween("d",()=>nt(M,Y))}else s.visible&&j.attr("d",v);S.attr("d",v).attr("visibility",O?null:"hidden")}),De(d.exit(),l).style("opacity",0).remove()}_emptyPath(){const e=this.xScale.range(),t=this.yScale.range();return`M${e[0]},${t[0]} L${e[1]},${t[0]}`}_highlight(e,t,n){const{config:l}=this;l.highlightOnHover&&this.g.selectAll(`.${se}`).classed(ke,u=>u!==e)}_resetHighlight(e,t,n){const{config:l}=this;l.highlightOnHover&&this.g.selectAll(`.${se}`).classed(ke,!1)}}ie.selectors=dt;function pt(o){let e,t,n;return{c(){e=E("vis-component")},l(l){e=P(l,"VIS-COMPONENT",{}),$(e).forEach(_)},m(l,u){X(l,e,u),t||(n=Xe(o[1].call(null,e,o[0])),t=!0)},p:ee,i:ee,o:ee,d(l){l&&_(e),t=!1,n()}}}function mt(o,e,t){const n=["data","x","y","getComponent"];let l=Me(e,n),{data:u=void 0}=e,{x:r}=e,{y:h}=e,d,a;const c=new ie(a),s=je("container");Ge(()=>c.destroy());function i(){return c}return o.$$set=f=>{e=Te(Te({},e),We(f)),t(8,l=Me(e,n)),"data"in f&&t(2,u=f.data),"x"in f&&t(3,r=f.x),"y"in f&&t(4,h=f.y)},o.$$.update=()=>{t(7,a=Object.assign({x:r,y:h},l)),o.$$.dirty&4&&(c==null||c.setData(u)),o.$$.dirty&192&&(it(d,a)||(c==null||c.setConfig(a),t(6,d=a)))},[c,s,u,r,h,i,d,a]}class gt extends ce{constructor(e){super(),fe(this,e,mt,pt,ue,{data:2,x:3,y:4,getComponent:5})}get getComponent(){return this.$$.ctx[5]}}const _t=gt;function vt(o){let e,t,n,l,u,r,h,d,a,c;return e=new _t({props:{x:o[5],y:o[3],color:o[2],curveType:Ee.Linear,highlightOnHover:!0}}),n=new Ve({props:{type:"x",label:"Month",numTicks:ve.length,tickFormat:at}}),u=new Ve({props:{type:"y",label:"Number of Posts"}}),h=new lt({props:{template:o[1],color:o[2]}}),a=new rt({props:{triggers:o[0]}}),{c(){R(e.$$.fragment),t=x(),R(n.$$.fragment),l=x(),R(u.$$.fragment),r=x(),R(h.$$.fragment),d=x(),R(a.$$.fragment)},l(s){F(e.$$.fragment,s),t=D(s),F(n.$$.fragment,s),l=D(s),F(u.$$.fragment,s),r=D(s),F(h.$$.fragment,s),d=D(s),F(a.$$.fragment,s)},m(s,i){z(e,s,i),X(s,t,i),z(n,s,i),X(s,l,i),z(u,s,i),X(s,r,i),z(h,s,i),X(s,d,i),z(a,s,i),c=!0},p(s,i){const f={};i&8&&(f.y=s[3]),i&4&&(f.color=s[2]),e.$set(f);const p={};i&2&&(p.template=s[1]),i&4&&(p.color=s[2]),h.$set(p);const g={};i&1&&(g.triggers=s[0]),a.$set(g)},i(s){c||(G(e.$$.fragment,s),G(n.$$.fragment,s),G(u.$$.fragment,s),G(h.$$.fragment,s),G(a.$$.fragment,s),c=!0)},o(s){W(e.$$.fragment,s),W(n.$$.fragment,s),W(u.$$.fragment,s),W(h.$$.fragment,s),W(a.$$.fragment,s),c=!1},d(s){U(e,s),s&&_(t),U(n,s),s&&_(l),U(u,s),s&&_(r),U(h,s),s&&_(d),U(a,s)}}}function yt(o){let e,t;return e=new ot({props:{data:o[4],height:"500",$$slots:{default:[vt]},$$scope:{ctx:o}}}),{c(){R(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,l){z(e,n,l),t=!0},p(n,[l]){const u={};l&16&&(u.data=n[4]),l&527&&(u.$$scope={dirty:l,ctx:n}),e.$set(u)},i(n){t||(G(e.$$.fragment,n),t=!0)},o(n){W(e.$$.fragment,n),t=!1},d(n){U(e,n)}}}const bt=5;function kt(o,e,t){let n,l,u,r,h,d,{posts:a}=e,{topics:c}=e;const s=({month:i})=>i;return o.$$set=i=>{"posts"in i&&t(6,a=i.posts),"topics"in i&&t(7,c=i.topics)},o.$$.update=()=>{o.$$.dirty&192&&t(4,n=[...ve.keys()].map(i=>a.filter(({timestamp:f})=>f.getMonth()===i).reduce((f,{topicId:p})=>(p in f.topics&&f.topics[p]++,f),{month:i,topics:c.reduce((f,{id:p})=>({...f,[p]:0}),{})}))),o.$$.dirty&128&&t(3,l=c.map(({id:i})=>({topics:f})=>f[i])),o.$$.dirty&128&&t(2,u=(i,f)=>{var p;return(p=c.find(({id:g})=>g===f))==null?void 0:p.color}),o.$$.dirty&128&&t(8,d=i=>{const f=c.find(({id:p})=>p===i);return f?`<span style="color: ${f.color};">&bull;</span> ${f.label}`:""}),o.$$.dirty&256&&t(1,r=i=>[`<b>${ve[i.month]}</b>`,...Object.entries(i.topics).sort((f,p)=>p[1]-f[1]).slice(0,bt).map(([f,p])=>`${d(+f)} (${p})`)].join("<br/>")),o.$$.dirty&256&&t(0,h={[ie.selectors.line]:(i,f)=>`<b>${d(f)}</b>`})},[h,r,u,l,n,s,a,c,d]}class Et extends ce{constructor(e){super(),fe(this,e,kt,yt,ue,{posts:6,topics:7})}}function Ae(o,e,t){const n=o.slice();return n[8]=e[t].id,n[9]=e[t].label,n[10]=e[t].color,n[11]=e[t].total,n[12]=e[t].sentiments,n}function He(o,e,t){const n=o.slice();return n[15]=e[t],n[17]=t,n}function Ie(o){let e;return{c(){e=E("div"),this.h()},l(t){e=P(t,"DIV",{class:!0,style:!0}),$(e).forEach(_),this.h()},h(){T(e,"class",o[2][o[17]]),re(e,"width",o[15]+"%")},m(t,n){X(t,e,n)},p(t,n){n&2&&re(e,"width",t[15]+"%")},d(t){t&&_(e)}}}function Le(o,e){let t,n,l,u,r,h=e[9]+"",d,a,c,s=e[11]+"",i,f,p,g,k,S,O=Math.round(e[12][0])+"",H,j,y,v,M,Y,I,q=Math.round(e[12][2])+"",J,K,Q,L,he,oe,Z=e[12],C=[];for(let N=0;N<Z.length;N+=1)C[N]=Ie(He(e,Z,N));return{key:o,first:null,c(){t=E("a"),n=E("div"),l=E("span"),u=x(),r=E("h2"),d=w(h),a=x(),c=E("p"),i=w(s),f=w(" posts"),p=x(),g=E("div"),k=E("div"),S=E("span"),H=w(O),j=w("%"),y=x(),v=E("span"),M=w("Sentiment"),Y=x(),I=E("span"),J=w(q),K=w("%"),Q=x(),L=E("div");for(let N=0;N<C.length;N+=1)C[N].c();he=x(),this.h()},l(N){t=P(N,"A",{href:!0,class:!0});var V=$(t);n=P(V,"DIV",{class:!0});var b=$(n);l=P(b,"SPAN",{class:!0,style:!0}),$(l).forEach(_),u=D(b),r=P(b,"H2",{class:!0});var te=$(r);d=A(te,h),te.forEach(_),a=D(b),c=P(b,"P",{class:!0});var de=$(c);i=A(de,s),f=A(de," posts"),de.forEach(_),p=D(b),g=P(b,"DIV",{class:!0});var ae=$(g);k=P(ae,"DIV",{class:!0});var B=$(k);S=P(B,"SPAN",{class:!0});var pe=$(S);H=A(pe,O),j=A(pe,"%"),pe.forEach(_),y=D(B),v=P(B,"SPAN",{class:!0});var Pe=$(v);M=A(Pe,"Sentiment"),Pe.forEach(_),Y=D(B),I=P(B,"SPAN",{class:!0});var me=$(I);J=A(me,q),K=A(me,"%"),me.forEach(_),B.forEach(_),Q=D(ae),L=P(ae,"DIV",{class:!0});var $e=$(L);for(let ge=0;ge<C.length;ge+=1)C[ge].l($e);$e.forEach(_),ae.forEach(_),b.forEach(_),he=D(V),V.forEach(_),this.h()},h(){T(l,"class","h-4 w-4 rounded-full"),re(l,"background-color",e[10]),T(r,"class","card-title flex-1"),T(c,"class","text-center"),T(S,"class","text-green-500"),T(v,"class","flex-1 text-center"),T(I,"class","text-red-500"),T(k,"class","flex flex-row"),T(L,"class","flex flex-row bg-base-200 rounded-full h-2 overflow-hidden"),T(g,"class","flex flex-col text-xs space-y-1 w-64"),T(n,"class","card-body flex flex-row px-4 py-2 items-center"),T(t,"href",oe=we+"/"+e[8]),T(t,"class","card bg-base-200 hover:bg-base-300 rounded border border-base-300 shadow"),this.first=t},m(N,V){X(N,t,V),m(t,n),m(n,l),m(n,u),m(n,r),m(r,d),m(n,a),m(n,c),m(c,i),m(c,f),m(n,p),m(n,g),m(g,k),m(k,S),m(S,H),m(S,j),m(k,y),m(k,v),m(v,M),m(k,Y),m(k,I),m(I,J),m(I,K),m(g,Q),m(g,L);for(let b=0;b<C.length;b+=1)C[b]&&C[b].m(L,null);m(t,he)},p(N,V){if(e=N,V&2&&re(l,"background-color",e[10]),V&2&&h!==(h=e[9]+"")&&le(d,h),V&2&&s!==(s=e[11]+"")&&le(i,s),V&2&&O!==(O=Math.round(e[12][0])+"")&&le(H,O),V&2&&q!==(q=Math.round(e[12][2])+"")&&le(J,q),V&6){Z=e[12];let b;for(b=0;b<Z.length;b+=1){const te=He(e,Z,b);C[b]?C[b].p(te,V):(C[b]=Ie(te),C[b].c(),C[b].m(L,null))}for(;b<C.length;b+=1)C[b].d(1);C.length=Z.length}V&2&&oe!==(oe=we+"/"+e[8])&&T(t,"href",oe)},d(N){N&&_(t),Fe(C,N)}}}function Pt(o){let e,t,n,l,u,r,h,d,a,c,s,i,f,p,g=[],k=new Map,S,O,H=o[1];const j=y=>y[8];for(let y=0;y<H.length;y+=1){let v=Ae(o,H,y),M=j(v);k.set(M,g[y]=Le(M,v))}return{c(){e=E("div"),t=E("div"),n=E("span"),l=w("Order by"),u=x(),r=E("select"),h=E("option"),d=w("Higest number of posts"),a=E("option"),c=w("Most positive topic"),s=E("option"),i=w("Most negative topic"),f=x(),p=E("div");for(let y=0;y<g.length;y+=1)g[y].c();this.h()},l(y){e=P(y,"DIV",{class:!0});var v=$(e);t=P(v,"DIV",{class:!0});var M=$(t);n=P(M,"SPAN",{});var Y=$(n);l=A(Y,"Order by"),Y.forEach(_),u=D(M),r=P(M,"SELECT",{class:!0});var I=$(r);h=P(I,"OPTION",{});var q=$(h);d=A(q,"Higest number of posts"),q.forEach(_),a=P(I,"OPTION",{});var J=$(a);c=A(J,"Most positive topic"),J.forEach(_),s=P(I,"OPTION",{});var K=$(s);i=A(K,"Most negative topic"),K.forEach(_),I.forEach(_),M.forEach(_),f=D(v),p=P(v,"DIV",{class:!0});var Q=$(p);for(let L=0;L<g.length;L+=1)g[L].l(Q);Q.forEach(_),v.forEach(_),this.h()},h(){h.__value=o[3].HigestPosts,h.value=h.__value,a.__value=o[3].MostPositive,a.value=a.__value,s.__value=o[3].MostNegative,s.value=s.__value,T(r,"class","select select-bordered"),o[0]===void 0&&Ye(()=>o[7].call(r)),T(t,"class","flex flex-row items-center justify-end space-x-4"),T(p,"class","flex flex-col gap-4 bg-red"),T(e,"class","space-y-4 mt-4")},m(y,v){X(y,e,v),m(e,t),m(t,n),m(n,l),m(t,u),m(t,r),m(r,h),m(h,d),m(r,a),m(a,c),m(r,s),m(s,i),Se(r,o[0],!0),m(e,f),m(e,p);for(let M=0;M<g.length;M+=1)g[M]&&g[M].m(p,null);S||(O=qe(r,"change",o[7]),S=!0)},p(y,[v]){v&9&&Se(r,y[0]),v&6&&(H=y[1],g=Re(g,v,j,1,y,H,k,p,ze,Le,null,Ae))},i:ee,o:ee,d(y){y&&_(e);for(let v=0;v<g.length;v+=1)g[v].d();S=!1,O()}}}function $t(o,e,t){let n,l;const u=["bg-green-500","bg-blue-500","bg-red-500"];var r=(s=>(s[s.HigestPosts=0]="HigestPosts",s[s.MostPositive=1]="MostPositive",s[s.MostNegative=2]="MostNegative",s))(r||{});let{topics:h}=e,{posts:d}=e,a=0;function c(){a=Ue(this),t(0,a),t(3,r)}return o.$$set=s=>{"topics"in s&&t(4,h=s.topics),"posts"in s&&t(5,d=s.posts)},o.$$.update=()=>{o.$$.dirty&48&&t(6,n=h.map(s=>{const i=ct.map(p=>d.filter(({topicId:g,sentiment:k})=>g===s.id&&k===p).length),f=i.reduce((p,g)=>p+g,0);return{...s,total:f,sentiments:i.map(p=>p*100/f)}})),o.$$.dirty&65&&t(1,l=[...n].sort(a===0?(s,i)=>i.total-s.total:a===1?(s,i)=>i.sentiments[0]-s.sentiments[0]:(s,i)=>i.sentiments[2]-s.sentiments[2]))},[a,l,u,r,h,d,n,c]}class Mt extends ce{constructor(e){super(),fe(this,e,$t,Pt,ue,{topics:4,posts:5})}}function Tt(o){let e,t;return e=new Et({props:{posts:o[2],topics:o[1]}}),{c(){R(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,l){z(e,n,l),t=!0},p:ee,i(n){t||(G(e.$$.fragment,n),t=!0)},o(n){W(e.$$.fragment,n),t=!1},d(n){U(e,n)}}}function St(o){let e,t,n,l,u,r,h,d=Tt(o);return r=new Mt({props:{posts:o[2],topics:o[1]}}),{c(){e=E("h1"),t=w(o[0]),n=w(" Most Discussed Topic by Expats in Estonia 2022"),l=x(),d&&d.c(),u=x(),R(r.$$.fragment),this.h()},l(a){e=P(a,"H1",{class:!0});var c=$(e);t=A(c,o[0]),n=A(c," Most Discussed Topic by Expats in Estonia 2022"),c.forEach(_),l=D(a),d&&d.l(a),u=D(a),F(r.$$.fragment,a),this.h()},h(){T(e,"class","font-sans font-bold text-4xl mb-12")},m(a,c){X(a,e,c),m(e,t),m(e,n),X(a,l,c),d&&d.m(a,c),X(a,u,c),z(r,a,c),h=!0},p(a,[c]){d.p(a,c)},i(a){h||(G(d),G(r.$$.fragment,a),h=!0)},o(a){W(d),W(r.$$.fragment,a),h=!1},d(a){a&&_(e),a&&_(l),d&&d.d(a),a&&_(u),U(r,a)}}}function Ot(o,e,t){let{data:n}=e;const{MAX_DISPLAY_TOPIC:l,topics:u,posts:r}=n;return o.$$set=h=>{"data"in h&&t(3,n=h.data)},[l,u,r,n]}class Dt extends ce{constructor(e){super(),fe(this,e,Ot,St,ue,{data:3})}}export{Dt as default};
